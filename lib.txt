CREATE TABLE PUBLISHER(Pid int,
NAME VARCHAR(18) ADDRESS
VARCHAR(10),
PHONE VARCHAR(10), PRIMARY KEY(pid,name));

CREATE TABLE BOOK(
BOOK_ID INTEGER PRIMARY
KEY, TITLE VARCHAR(20),
PUBLISHER_NAME VARCHAR(20)REFERENCES PUBLISHER(NAME)ON
DELETE CASADE,
PUB_YEAR NUMBER(4));

CREATE TABLE BOOK_AUTHORS(
BOOK_ID INTEGER REFERENCES BOOK(BOOK_ID) ON DELETE
CASCADE, AUTHOR_NAME VARCHAR(20),
PRIMARY KEY(BOOK_ID));

 CREATE TABLE
LIBRARY_BRANCH( BRANCH_ID
INTEGER PRIMARY KEY,
BRANCH_NAME VARCHAR(18),
ADDRESS VARCHAR(15));

 CREATE TABLE BOOK_COPIES(
BOOK_ID INTEGER REFERENCES BOOK(BOOK_ID) ON DELETE CASCADE,
BRANCH_ID INTEGER REFERENCES LIBRARY_BRANCH(BRANCH_ID) ON
DELETE CASCADE,
NO_OF_COPIES INTEGER,
PRIMARY KEY(BOOK_ID,BRANCH_ID));

CREATE TABLE BOOK_LENDING(
BOOK_ID INTEGER REFERENCES BOOK(BOOK_ID) ON DELETE CASCADE,
BRANCH_ID INTEGER REFERENCES LIBRARY_BRANCH(BRANCH_ID) ON
DELETE CASCADE,
CARD_NO
INTEGER,
DATE_OUT DATE,
DUE_DATE DATE,
PRIMARY KEY(BOOK_ID,BRANCH_ID,CARD_NO));
SQL>INSERT INTO PUBLISHER VALUES( ‘1001’,'PEARSON','BANGALORE','9875462530');
SQL> INSERT INTO PUBLISHER VALUES('1002’,’MCGRAW','NEWDELHI','7845691234');
SQL> INSERT INTO PUBLISHER VALUES(‘1003’,'SAPNA','BANGALORE','7845963210');

SQL> INSERT INTO BOOK VALUES(1111,'SE','PEARSON',2005);
SQL> INSERT INTO BOOK VALUES(2222,'DBMS','MCGRAW',2004);
SQL> INSERT INTO BOOKVALUES(3333,'ANOTOMY','PEARSON',2010);
SQL> INSERT INTO BOOK VALUES(4444,'ENCYCLOPEDIA','SAPNA',2010);

SQL> INSERT INTO BOOK_AUTHORS VALUES(1111,'SOMMERVILLE');
SQL> INSERT INTO BOOK_AUTHORS VALUES(2222,'NAVATHE');
SQL> INSERT INTO BOOK_AUTHORS VALUES(3333,'HENRY GRAY');
SQL> INSERT INTO BOOK_AUTHORS VALUES(4444,'THOMAS');

SQL> INSERT INTO LIBRARY_BRANCH VALUES(11,'CENTRAL TECHNICAL','MG ROAD');
SQL> INSERT INTO LIBRARY_BRANCH VALUES(22,'MEDICAL','BH ROAD');
SQL> INSERT INTO LIBRARY_BRANCH VALUES(33,'CHILDREN','SS PURAM');
SQL> INSERT INTO LIBRARY_BRANCH VALUES(44,'SECRETARIAT','SIRAGATE');
SQL> INSERT INTO LIBRARY_BRANCH VALUES(55,'GENERAL','JAYANAGAR');

SQL> INSERT INTO BOOK_COPIES VALUES(1111,11,5);
SQL> INSERT INTO BOOK_COPIES VALUES(3333,22,6);
SQL> INSERT INTO BOOK_COPIES VALUES(4444,33,10);
SQL> INSERT INTO BOOK_COPIES VALUES(2222,11,12);
SQL> INSERT INTO BOOK_COPIES VALUES(4444,55,3);

SQL> INSERT INTO BOOK_LENDING VALUES(2222,11,1,'10-JAN-2017','20-AUG-2017');
SQL> INSERT INTO BOOK_LENDING VALUES(3333,22,2,'09-JUL-2017','12-AUG-2017');
SQL> INSERT INTO BOOK_LENDING VALUES(4444,55,1,'11-APR-2017','09-AUG-2017');
SQL> INSERT INTO BOOK_LENDING VALUES(2222,11,5,'09-AUG-2017','19-AUG-2017');
SQL> INSERT INTO BOOK_LENDING VALUES(4444,33,1,'10-JUN-2017','15-AUG-2017');
SQL> INSERT INTO BOOK_LENDING VALUES(1111,11,1,'12-MAY-2017','10-JUN-2017');
SQL> INSERT INTO BOOK_LENDING VALUES(3333,22,1,'10-JUL-2017','15-JUL-2017');


Retrieve details of all books in the library – id, title, name of publisher, authors, number of
copies in each branch, etc.
SELECT LB.BRANCH_NAME, B.BOOK_ID,TITLE,
PUBLISHER_NAME,AUTHOR_NAME, NO_OF_COPIES
FROM BOOK B, BOOK_AUTHORS BA, BOOK_COPIES BC, LIBRARY_BRANCH
LB
WHERE B.BOOK_ID = BA.BOOK_ID
AND BA.BOOK_ID =
BC.BOOK_ID AND
BC.BRANCH_ID =
LB.BRANCH_ID
GROUP BY LB.BRANCH_NAME, B.BOOK_ID, TITLE,
PUBLISHER_NAME, AUTHOR_NAME,
NO_OF_COPIES;


Get the particulars of borrowers who have borrowed more than 3 books, but from Jan 2017
to Jun 2017.
SELECT CARD_NO
FROM BOOK_LENDING
WHERE DATE_OUT BETWEEN '01-JAN-2017' AND '30-JUN-2017'
GROUP BY CARD_NO
HAVING COUNT(*) > 3;

 Delete a book in BOOK table. Update the contents of other tables to reflect this data
manipulation operation.
DELETE FROM BOOK
WHERE BOOK_ID = '3333';


Partition the BOOK table based on year of publication. Demonstrate its working with a
simple query.
SELECT BOOK_ID, TITLE, PUBLISHER_NAME, PUB_YEAR
FROM BOOK
GROUP BY PUB_YEAR, BOOK_ID, TITLE, PUBLISHER_NAME;


) Create a view of all books and its number of copies that are currently available in the
Library.
CREATE VIEW BOOKS_AVAILABLE AS
SELECT B.BOOK_ID, B.TITLE,
C.NO_OF_COPIES FROM LIBRARY_BRANCH L,
BOOK B, BOOK_COPIES C WHERE B.BOOK_ID
= C.BOOK_ID AND
L.BRANCH_ID=C.BRANCH_ID;